<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AI Similar Redirect</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
 body { font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; background:#0e1116; color:#e6e6e6; margin:0; padding:2rem; }
 h1 { font-size:1.25rem; margin:0 0 .75rem; }
 p { line-height:1.35; }
 a { color:#4db1ff; }
 .card { max-width:520px; background:#1b222c; padding:1.25rem 1.5rem; border-radius:12px; box-shadow:0 4px 18px -6px rgba(0,0,0,.6); }
 .spinner { width:42px; height:42px; border:4px solid #2d3947; border-top-color:#4db1ff; border-radius:50%; animation:spin 1s linear infinite; margin:1.25rem auto; }
 @keyframes spin { to { transform:rotate(360deg);} }
 .hidden { display:none; }
</style>
<script>
(function(){
  function qs(key){ return new URLSearchParams(location.search).get(key); }
  const type = qs('type') || 'movie';
  const id = qs('id') || '';
  const deepLink = `stremio://discover/${type}/ai-similar/imdbId=${id}`;
  // Attempt deep link quickly
  let opened = false;
  function attempt(){
    try { window.location.href = deepLink; } catch(e) {}
    setTimeout(() => {
      if (!opened) {
        document.getElementById('fallback').classList.remove('hidden');
        document.getElementById('deepLink').href = deepLink;
      }
    }, 1200);
  }
  window.addEventListener('pagehide', () => { opened = true; });
  document.addEventListener('DOMContentLoaded', attempt);
})();
</script>
</head>
<body>
  <div class="card">
    <h1>Opening AI Similarâ€¦</h1>
    <div class="spinner" aria-hidden="true"></div>
    <p>Trying to open the Stremio Discover view with this title's AI recommendations.</p>
    <div id="fallback" class="hidden">
      <p>If nothing happened, tap: <a id="deepLink">Open AI Similar in Stremio</a></p>
      <p>Or manually: Discover &gt; AI Similar &gt; imdbId=<code id="imdbVal"></code></p>
    </div>
  </div>
<script>
  document.getElementById('imdbVal').textContent = new URLSearchParams(location.search).get('id') || '';
</script>
</body>
</html>
